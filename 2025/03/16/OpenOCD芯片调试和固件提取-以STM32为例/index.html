

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="../../../../img/touxiang.png">
  <link rel="icon" href="../../../../img/touxiang.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="0P1N">
  <meta name="keywords" content="">
  
    <meta name="description" content="OpenOCD芯片调试及固件提取-以STM32为例前言 OpenOCD支持多种处理器架构、接口和仿真器，并且可拓展，是一个相对通用的开源片上调试工具，主要用于嵌入式系统的调试、编程和测试。本文介绍其用法并用它来调试STM32芯片和提取固件。  除了OpenOCD，也可以用STM32CubeProgrammer等IDE读写固件 ，功能更全面，图形化程度更高，也有其它特定调试器的配套软件如针对JLIN">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenOCD芯片调试和固件提取-以STM32为例">
<meta property="og:url" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/index.html">
<meta property="og:site_name" content="0P1N">
<meta property="og:description" content="OpenOCD芯片调试及固件提取-以STM32为例前言 OpenOCD支持多种处理器架构、接口和仿真器，并且可拓展，是一个相对通用的开源片上调试工具，主要用于嵌入式系统的调试、编程和测试。本文介绍其用法并用它来调试STM32芯片和提取固件。  除了OpenOCD，也可以用STM32CubeProgrammer等IDE读写固件 ，功能更全面，图形化程度更高，也有其它特定调试器的配套软件如针对JLIN">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/1.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/2.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/3.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/4.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/5.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/6.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/7.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/8.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/9.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/10.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/11.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/12.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/13.png">
<meta property="og:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/14.png">
<meta property="article:published_time" content="2025-03-16T07:34:00.000Z">
<meta property="article:modified_time" content="2025-03-16T09:05:57.844Z">
<meta property="article:author" content="0P1N">
<meta property="article:tag" content="固件提取">
<meta property="article:tag" content="STM32">
<meta property="article:tag" content="OpenOCD">
<meta property="article:tag" content="芯片调试">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://lkliki.github.io/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/1.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>OpenOCD芯片调试和固件提取-以STM32为例 - 0P1N</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="../../../../css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="../../../../css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="../../../../css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"lkliki.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"|","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="../../../../js/utils.js" ></script>
  <script  src="../../../../js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="../../../../index.html">
      <strong>Welcome To 0P1N&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../index.html">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="../../../../links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('../../../../img/background.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="OpenOCD芯片调试和固件提取-以STM32为例"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-03-16 15:34" pubdate>
          2025年3月16日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5.4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          45 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">OpenOCD芯片调试和固件提取-以STM32为例</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="OpenOCD芯片调试及固件提取-以STM32为例"><a href="#OpenOCD芯片调试及固件提取-以STM32为例" class="headerlink" title="OpenOCD芯片调试及固件提取-以STM32为例"></a>OpenOCD芯片调试及固件提取-以STM32为例</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ul>
<li><p>OpenOCD支持多种处理器架构、接口和仿真器，并且可拓展，是一个相对通用的开源片上调试工具，主要用于嵌入式系统的调试、编程和测试。本文介绍其用法并用它来调试STM32芯片和提取固件。</p>
</li>
<li><p>除了OpenOCD，也可以用<code>STM32CubeProgrammer</code>等IDE读写固件 ，功能更全面，图形化程度更高，也有其它特定调试器的配套软件如针对JLINK的jflash等。</p>
</li>
<li><p>相对其它工具，OpenOCD优势在于开源、灵活性强(兼容多种仿真器和芯片且可拓展)、轻量(命令行式操作)，可以将其集成到其它工具或开发流程中。</p>
</li>
<li><p>如果STM32开启了RDP(读保护)，则无法通过该方式读写flash，需要关闭保护或利用漏洞、故障注入等手段绕过保护。</p>
</li>
</ul>
<h2 id="设备基本信息"><a href="#设备基本信息" class="headerlink" title="设备基本信息"></a>设备基本信息</h2><p>PC环境：ubuntu2004虚拟机</p>
<p>仿真器：<strong>CMSIS-DAP</strong></p>
<p>MCU芯片型号：<strong>STM32F407ZGT6</strong></p>
<p>打开数据手册查看内存 映射中Flash的位置：<strong>0x0800 0000-0x080F FFFF</strong></p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/1.png" srcset="/img/loading.gif" lazyload alt="1"></p>
<h2 id="OpenOCD简介"><a href="#OpenOCD简介" class="headerlink" title="OpenOCD简介"></a>OpenOCD简介</h2><p>全称Open On-Chip Debugger(开放式片上调试器)，由Dominic Rath开发，是其<a target="_blank" rel="noopener" href="https://openocd.org/files/thesis.pdf">毕业论文</a>的一部分，最初是针对ARM7和ARM9芯片的片上调试。</p>
<p>OpenOCD提供对嵌入式设备的调试烧录、系统编程和边界扫描功能，可以配合仿真器连接设备的调试接口(尤其是<code>JTAG/SWD</code>)。</p>
<p><a target="_blank" rel="noopener" href="https://openocd.org/pages/about.html">OpenOCD官网</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/openocd-org/openocd">OpenOCD Github</a></p>
<h2 id="OpenOCD架构和原理"><a href="#OpenOCD架构和原理" class="headerlink" title="OpenOCD架构和原理"></a>OpenOCD架构和原理</h2><p><a target="_blank" rel="noopener" href="https://openocd.org/files/thesis.pdf">论文</a>的第40页介绍了OpenOCD的架构，包含了如下几个模块</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/2.png" srcset="/img/loading.gif" lazyload alt="2"></p>
<ul>
<li><p><code>Daemon模块</code>：守护进程（daemon）是首先被初始化的部分，它控制着其余组件。守护进程通过评估命令行参数来管理程序配置，并使用CLI模块解析配置文件。每个模块都可以向CLI模块注册命令，这些命令既可用作配置语句，也可作为用户命令，或者在配置选项后续可能更改的情况下同时用于两者。</p>
</li>
<li><p><code>JTAG模块</code>：JTAG模块是唯一直接访问被调试硬件的部分，它为其他模块提供了与目标设备通信的接口。</p>
</li>
<li><p><code>Target模块</code>：目标(Target)模块封装了常见的调试功能，并向CLI模块注册特定于目标的命令。守护进程在等待新连接时通过访问目标模块来跟踪目标状态，并向GDB和CLI模块提供目标调试功能。</p>
</li>
<li><p><code>GDB模块</code>：GDB模块在守护进程接受新的GDB连接后被调用，它将GDB远程串行协议映射到目标模块提供的接口上。GDB远程协议中定义了一种监控数据包（monitor packet），允许发送应由GDB服务器解释的命令。GDB模块将这些命令字符串交给CLI模块进行评估，并将任何回复返回给远程GDB，从而将GDB会话中可访问的功能扩展到各个模块提供的所有命令。</p>
</li>
<li><p><code>CLI模块</code>：CLI模块实现了telnet服务器，处理配置解析，并允许其他模块注册命令。</p>
</li>
<li><p><code>Flash模块</code>：闪存(Flash)模块仅通过命令接口访问，因为GDB协议未规定闪存操作，它利用Target模块提供的内存访问功能来编程闪存芯片。</p>
</li>
</ul>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/3.png" srcset="/img/loading.gif" lazyload alt="3"></p>
<p>Target模块将目标状态分为四种：unknown(未知)、reset(重置)、running(运行)和halt(停止)。其中比较重要的是运行和停止状态。类似gdb的调试，运行状态可以通过断点或CLI中的halt指令切换到停止状态；停止状态下可以下断点、检查寄存器和读写内存，也可以恢复到运行状态，有单步执行功能。更详细的介绍请参考论文6.4节。</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/4.png" srcset="/img/loading.gif" lazyload alt="4"></p>
<h2 id="OpenOCD安装"><a href="#OpenOCD安装" class="headerlink" title="OpenOCD安装"></a>OpenOCD安装</h2><p>ubuntu上用apt包管理器安装即可</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo apt <span class="hljs-keyword">install</span> openocd<br></code></pre></td></tr></table></figure>

<p>要获取指定版本的OpenOCD可以编译源码或下载编译好的release包。参考<a target="_blank" rel="noopener" href="https://openocd.org/pages/getting-openocd.html">Getting OpenOCD</a>。</p>
<h2 id="OpenOCD使用"><a href="#OpenOCD使用" class="headerlink" title="OpenOCD使用"></a>OpenOCD使用</h2><h3 id="导入配置文件"><a href="#导入配置文件" class="headerlink" title="导入配置文件"></a>导入配置文件</h3><p>OpenOCD需要导入正确的<code>cfg</code>配置文件才能连接调试目标，其针对常见硬件提供了的现成的cfg文件，位于<code>/usr/share/openocd/scripts</code>目录。</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/5.png" srcset="/img/loading.gif" lazyload alt="5"></p>
<p>最基本的要求是导入<code>target</code>和<code>interface</code>中对应的cfg配置文件。target指芯片型号，interface指调试器类型。</p>
<p>如果没有现成的，我们也可以自己编写cfg文件。编写cfg文件用到的是<code>TCL</code>脚本语言：<a target="_blank" rel="noopener" href="https://openocd.org/doc/doxygen/html/primertcl.html">OpenOCD开发文档-TCL 入门</a>。</p>
<h3 id="CLI交互"><a href="#CLI交互" class="headerlink" title="CLI交互"></a>CLI交互</h3><p>openocd导入配置文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">openocd <span class="hljs-operator">-f</span> <span class="hljs-string">&#x27;/usr/share/openocd/scripts/interface/your_debugger.cfg&#x27;</span> <span class="hljs-operator">-f</span> <span class="hljs-string">&#x27;/usr/share/openocd/scripts/target/your_mcu.cfg&#x27;</span><br></code></pre></td></tr></table></figure>

<p>新开一个shell，telnet连接CLI(默认4444端口)</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">telnet</span> localhost <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<p>然后就可以和CLI交互了。一般刚连上目标处于运行状态，需要先输入<code>halt</code>指令进入停止状态才能进行查看寄存器或访问内存等操作。</p>
<p>常用命令如下(截取自该<a target="_blank" rel="noopener" href="https://kingtuo123.com/posts/openocd/">博客</a>)：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">telnet localhost 4444</span><br>Open On-Chip Debugger<br> reset    # 复位<br> init     # 初始化设备<br> halt     # 停止运行<br> step     # 单步执行<br> resume   # 恢复运行<br> step 0x08000648 # 运行到地址0x08000648处后单步执行<br><br> reset run  # 复位并立即运行<br> reset halt # 复位并立即停止<br> reset init # 复位并立即初始化<br><br> halt                                            # 写入程序前要先停止设备<br> program ./target.hex                            # 写入 hex<br> program ./target.bin 0x08000000                 # 写入 bin<br> flash write_image erase ./target.hex            # 擦除后写入 hex 文件<br> flash write_image erase ./target.bin 0x08000000 # 擦除后写入 bin 文件<br><br> reg                      # 列出所有寄存器<br> halt                     # 停止设备<br> set_reg &#123;pc 0 sp 0x1000&#125; # 写PC,SP寄存器<br> get_reg &#123;pc sp&#125;          # 读PC,SP寄存器<br>pc 0x00000000 sp 0x00001000<br><br> write_memory 0x20000000 32 &#123;0xdeadbeef 0x00230500&#125;  # 向内存写入两个32位数据<br> read_memory 0x20000000 32 2                         # 读取两个32位数据<br>0xdeadbeef 0x230500 <br><br> mdd 0x08000000 1 # 读1个64位的数据<br> mdw 0x08000000 1 # 读1个32位的数据<br> mdh 0x08000000 1 # 读1个16位的数据<br> mdb 0x08000000 1 # 读1个 8位的数据<br><br> mwd 0x20000000 0xaaaabbbbccccdddd # 写1个64位的数据<br> mww 0x20000000 0xaaaabbbb         # 写1个32位的数据<br> mwh 0x20000000 0xaaaa             # 写1个16位的数据<br> mwb 0x20000000 0xaa               # 写1个 8位的数据<br><br> bp                 # 查看所有断点<br> bp 0x08000648 2 hw # 在地址0x08000648处设置硬件断点<br> rbp 0x08000648     # 删除该地址的断点<br> rbp all            # 删除所有断点<br><br> exit # 退出<br></code></pre></td></tr></table></figure>

<p>更多指令参考：<a target="_blank" rel="noopener" href="https://openocd.org/doc/html/General-Commands.html">General Commands</a></p>
<h3 id="GDB调试"><a href="#GDB调试" class="headerlink" title="GDB调试"></a>GDB调试</h3><p><strong>获取交叉编译工具</strong></p>
<p>需要从对应芯片的交叉编译工具链中获取专用的<code>gdb</code>。  </p>
<p> <a target="_blank" rel="noopener" href="https://developer.arm.com/downloads/-/arm-gnu-toolchain-downloads">Arm GNU 工具链下载</a></p>
<p><a target="_blank" rel="noopener" href="https://firmware.ardupilot.org/Tools/STM32-tools/">STM32编译工具链下载</a></p>
<p>支持的目标架构分类</p>
<ul>
<li><strong>AArch32</strong>：<ul>
<li>裸机：<code>arm-none-eabi</code></li>
<li>GNU&#x2F;Linux硬浮点：<code>arm-none-linux-gnueabihf</code></li>
</ul>
</li>
<li><strong>AArch64</strong>：<ul>
<li>裸机：<code>aarch64-none-elf</code></li>
<li>GNU&#x2F;Linux：<code>aarch64-none-linux-gnu</code></li>
<li>GNU&#x2F;Linux大端：<code>aarch64_be-none-linux-gnu</code></li>
</ul>
</li>
</ul>
<p><strong>进行调试</strong></p>
<p>首先导入配置文件。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">openocd <span class="hljs-operator">-f</span> <span class="hljs-string">&#x27;/usr/share/openocd/scripts/interface/your_debugger.cfg&#x27;</span> <span class="hljs-operator">-f</span> <span class="hljs-string">&#x27;/usr/share/openocd/scripts/target/your_mcu.cfg&#x27;</span><br></code></pre></td></tr></table></figure>

<p>新开一个shell，运行gdb后输入<code>target remote localhost:3333</code>连接到gdbserver。注意交叉编译工具链中的gdb名称可能不同。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">gdb</span> <br>(gdb) file &quot;./target.elf&quot;<br>(gdb) target extended-remote localhost:3333<br></code></pre></td></tr></table></figure>

<p>这里的<code>target.elf</code>指设备中正在运行的程序的可执行文件，通常在IDE编译后产生。 </p>
<p>整体架构如下，Gdb Server端口是3333。</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/6.png" srcset="/img/loading.gif" lazyload alt="6"></p>
<p>GDB常用指令(截取自该<a target="_blank" rel="noopener" href="https://kingtuo123.com/posts/openocd/">博客</a>):</p>
<table>
<thead>
<tr>
<th align="left">指令</th>
<th align="left">简写</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>help</code></td>
<td align="left"><code>h</code></td>
<td align="left">打印帮助信息</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>h next</code> ：打印 next 指令的用法说明</td>
</tr>
<tr>
<td align="left"><code>file</code></td>
<td align="left"></td>
<td align="left">指定程序文件</td>
</tr>
<tr>
<td align="left"><code>load</code></td>
<td align="left"></td>
<td align="left">加载 file 指定的程序文件</td>
</tr>
<tr>
<td align="left"><code>break</code></td>
<td align="left"><code>b</code></td>
<td align="left">设置断点</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>b main</code> ：在 main 函数处设置断点</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>b 10</code> ：在第 10 行设置断点</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>b test.c:10</code> ： 在 test.c 的第 10 行设置断点</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>b if a == 1</code> ： 当 a 等于 1 时打断</td>
</tr>
<tr>
<td align="left"><code>tbreak</code></td>
<td align="left"><code>tb</code></td>
<td align="left">设置临时断点，只作用一次</td>
</tr>
<tr>
<td align="left"><code>info</code></td>
<td align="left"><code>i</code></td>
<td align="left">显示调试信息</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>i b</code> ：显示所有断点</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>i display</code> ：显示所有表达式</td>
</tr>
<tr>
<td align="left"><code>delete</code></td>
<td align="left"><code>d</code></td>
<td align="left">删除断点等</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>d</code> ：删除所有断点</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>d 2</code> ：删除 2 号断点</td>
</tr>
<tr>
<td align="left"><code>run</code></td>
<td align="left"><code>r</code></td>
<td align="left">从头开始执行程序</td>
</tr>
<tr>
<td align="left"><code>next</code></td>
<td align="left"><code>n</code></td>
<td align="left">执行一条 C 语句，不进入函数</td>
</tr>
<tr>
<td align="left"><code>step</code></td>
<td align="left"><code>s</code></td>
<td align="left">执行一条 C 语句，进入函数</td>
</tr>
<tr>
<td align="left"><code>nexti</code></td>
<td align="left"><code>ni</code></td>
<td align="left">执行一条汇编语句，不进入函数</td>
</tr>
<tr>
<td align="left"><code>stepi</code></td>
<td align="left"><code>si</code></td>
<td align="left">执行一条汇编语句，进入函数</td>
</tr>
<tr>
<td align="left"><code>continue</code></td>
<td align="left"><code>c</code></td>
<td align="left">继续执行</td>
</tr>
<tr>
<td align="left"><code>finish</code></td>
<td align="left"><code>fin</code></td>
<td align="left">跳出当前函数</td>
</tr>
<tr>
<td align="left"><code>until</code></td>
<td align="left"><code>u</code></td>
<td align="left">跳出当前循环</td>
</tr>
<tr>
<td align="left"><code>backtrace</code></td>
<td align="left"><code>bt</code></td>
<td align="left">打印所有栈帧</td>
</tr>
<tr>
<td align="left"><code>frame</code></td>
<td align="left"><code>f</code></td>
<td align="left">打印当前栈帧</td>
</tr>
<tr>
<td align="left"><code>print</code></td>
<td align="left"><code>p</code></td>
<td align="left">打印变量或表达式的值</td>
</tr>
<tr>
<td align="left"><code>display</code></td>
<td align="left"><code>disp</code></td>
<td align="left">增加要显示值的表达式(disp+后缀&#x2F;x&#x3D;16进制，&#x2F;i&#x3D;汇编指令，&#x2F;x&#x3D;字符串等)</td>
</tr>
<tr>
<td align="left"><code>call</code></td>
<td align="left"></td>
<td align="left">调用函数</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>call func(1, 2)</code> ：调用 func 函数</td>
</tr>
<tr>
<td align="left"><code>tui enable</code></td>
<td align="left"><code>-</code></td>
<td align="left">启用字符图形窗口</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>focus cmd</code> ：聚焦到 cmd 窗口</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>layout asm</code> ：显示汇编窗口，其他还有 src、regs、split</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>winheight src -2</code> ：调整源码窗口高度-2</td>
</tr>
<tr>
<td align="left"><code>tui disable</code></td>
<td align="left"></td>
<td align="left">关闭字符图形窗口</td>
</tr>
<tr>
<td align="left"><code>disassemble &lt;address&gt;</code></td>
<td align="left"></td>
<td align="left">将给定的地址转换为汇编代码</td>
</tr>
<tr>
<td align="left"><code>info threads</code></td>
<td align="left"></td>
<td align="left">显示所有线程的状态</td>
</tr>
<tr>
<td align="left"><code>info line * &lt;address&gt;</code></td>
<td align="left"></td>
<td align="left">显示给定地址的 c++ 行源码信息</td>
</tr>
<tr>
<td align="left"><code>info all-registers</code></td>
<td align="left"></td>
<td align="left">查看所有寄存器信息</td>
</tr>
</tbody></table>
<h2 id="STM32-固件提取"><a href="#STM32-固件提取" class="headerlink" title="STM32 固件提取"></a>STM32 固件提取</h2><p>根据所用的仿真器和MCU芯片型号导入配置文件</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">openocd</span> -f <span class="hljs-string">&#x27;/usr/share/openocd/scripts/interface/cmsis-dap.cfg&#x27;</span> - f <span class="hljs-string">&#x27;/usr/share/openocd/scripts/target/stm32f4x.cfg&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/7.png" srcset="/img/loading.gif" lazyload alt="7"></p>
<p>然后<code>telnet localhost 4444</code>连接CLI，<code>halt</code>进入停止状态</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/8.png" srcset="/img/loading.gif" lazyload alt="8"></p>
<p>最后用<code>dump_image</code>命令，结合数据手册中flash在内存中的映射地址范围，提取固件并命名为flash.bin</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">dump_image</span> flash.bin <span class="hljs-number">0</span>x08000000 <span class="hljs-number">0</span>x100000 <br></code></pre></td></tr></table></figure>

<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/9.png" srcset="/img/loading.gif" lazyload alt="9"></p>
<h2 id="STM32-Gdb调试"><a href="#STM32-Gdb调试" class="headerlink" title="STM32 Gdb调试"></a>STM32 Gdb调试</h2><p>获取Linux系统下32位arm裸机的编译工具链</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/10.png" srcset="/img/loading.gif" lazyload alt="10"></p>
<p>获取编译后的ELF可执行文件，笔者用keil编译烧录了一个点灯程序</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/11.png" srcset="/img/loading.gif" lazyload alt="11"></p>
<p>是否生成ELF、文件名称和位置在魔法棒中设置</p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/12.png" srcset="/img/loading.gif" lazyload alt="12"></p>
<p>根据所用的仿真器和MCU芯片型号导入配置文件</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">openocd</span> -f <span class="hljs-string">&#x27;/usr/share/openocd/scripts/interface/cmsis-dap.cfg&#x27;</span> - f <span class="hljs-string">&#x27;/usr/share/openocd/scripts/target/stm32f4x.cfg&#x27;</span><br></code></pre></td></tr></table></figure>

<p>解压编译工具链压缩包，运行bin目录下的<code>arm-none-eabi-gdb</code></p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">op1n<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~/Desktop/arm-gnu-toolchain-</span><span class="hljs-number">14.2</span>.rel1-x86_64-arm-none-eabi/bin<span class="hljs-variable">$ </span>./arm-none-eabi-gdb<br></code></pre></td></tr></table></figure>

<p>导入目标程序的ELF可执行文件</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi">(gdb) <span class="hljs-keyword">file</span> <span class="hljs-string">&#x27;/home/op1n/Desktop/demo.axf&#x27;</span> <br></code></pre></td></tr></table></figure>

<p>连接Gdb Server</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs aspectj">(gdb) <span class="hljs-keyword">target</span> extended-remote localhost:3333<br></code></pre></td></tr></table></figure>

<p>启用字符图形窗口<code>tui enable</code>，显示汇编<code>layout asm</code></p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/13.png" srcset="/img/loading.gif" lazyload alt="13"></p>
<p>显示寄存器<code>layout regs</code></p>
<p><img src="/2025/03/16/OpenOCD%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95%E5%92%8C%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96-%E4%BB%A5STM32%E4%B8%BA%E4%BE%8B/14.png" srcset="/img/loading.gif" lazyload alt="14"></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/671507382">【芯片调试】OpenOCD是什么？</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36955622/article/details/135261630?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-135261630-blog-132088423.235%5Ev43%5Epc_blog_bottom_relevance_base3&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-135261630-blog-132088423.235%5Ev43%5Epc_blog_bottom_relevance_base3&utm_relevant_index=1">OpenOCD简介和下载安装（Ubuntu）</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/CZ010822/article/details/132088423">使用OpenOCD提取STM32固件</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44656481/article/details/132415560">OpenOCD笔记</a></p>
<p><a target="_blank" rel="noopener" href="https://keaa.net/openocd-flash-program-daplink-debug.html">OpenOCD命令操作</a></p>
<p><a target="_blank" rel="noopener" href="https://ardupilot.org/dev/docs/debugging-with-gdb-on-stm32.html">Debugging with GDB on STM32</a></p>
<p><a target="_blank" rel="noopener" href="https://kingtuo123.com/posts/openocd/">OpenOCD + GDB 调试</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Megahertz66/article/details/137124920">使用 OpenOCD 来调试 STM32</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="../../../../categories/IOT/" class="category-chain-item">IOT</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="../../../../tags/%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96/">#固件提取</a>
      
        <a href="../../../../tags/STM32/">#STM32</a>
      
        <a href="../../../../tags/OpenOCD/">#OpenOCD</a>
      
        <a href="../../../../tags/%E8%8A%AF%E7%89%87%E8%B0%83%E8%AF%95/">#芯片调试</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>OpenOCD芯片调试和固件提取-以STM32为例</div>
      <div>https://lkliki.github.io/2025/03/16/OpenOCD芯片调试和固件提取-以STM32为例/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>0P1N</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年3月16日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="../../08/Frida-Labs%E7%AC%94%E8%AE%B0/" title="Frida_Labs笔记">
                        <span class="hidden-mobile">Frida_Labs笔记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href=""><span>fffer</span></a> <i class="iconfont icon-bug"></i> <a href="" target="_blank" rel="nofollow noopener"><span>0p1n</span></a> <br /> <a href=""><span>富强 民主 文明 和谐 自由 平等 公正 法治 爱国 敬业 诚信 友善</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="../../../../js/events.js" ></script>
<script  src="../../../../js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="../../../../js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="../../../../js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="../../../../js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
